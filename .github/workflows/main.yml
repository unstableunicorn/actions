name: main

on:
  push:
    paths-ignore:
      - ".gitignore"
      - "LICENSE"
      - "README.md"
    branches:
      - "main"

jobs:
  changes:
    runs-on: ubuntu-latest
    outputs:
      srcout: ${{ steps.filter.outputs.src }}
      filters: ${{ steps.filter.outputs.changes }}
      files: ${{ steps.filter.outputs.changed_files }}
    steps:
    - uses: actions/checkout@v3
    - uses: dorny/paths-filter@v2
      id: filter
      with:
        list-files: 'json'
        filters: |
          src:
            - src/**

  basic:
    needs: changes
    if: ${{ needs.changes.outputs.srcout == 'true' }}
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: "changed filters"
        run: echo "${{ needs.changes.outputs.filters }}"

      - name: "changed files"
        run: echo "${{ needs.changes.outputs.files }}"
  
  child:
    uses: ./.github/workflows/child1.yml
